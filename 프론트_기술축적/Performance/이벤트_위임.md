# HTML 이벤트
버블링 : 발생한 이벤트가 상위 -> 하위 요소로 타고 내려가는 현상
캡쳐링 : 발생한 이벤트가 하위 -> 상위 요소로 타고 올라가는 현상


# 이벤트 위임
이벤트 위임은 캡쳐링 개념을 활용했다. 하위에서 발생한 이벤트를 상위에서 처리하도록 하여, 여러개의 하위 자식 요소에 이벤트 핸들러를 각각 등록할 필요가 없다. 덕분에 모든 자식요소에 이벤트 핸들러를 리랜더링 될 때마다 새로 생성해서 내려다 주지 않아도 되기 때문에, 리랜더링 성능을 최적화 할 수 있다.

- 매번 생성 안해도 되기 때문에
- 생성될 때마다 모든 자식 컴포넌트가 리랜더링 될 필요가 없기 때문에


# 이벤트 합성
React 는 어떤 환경에서도 사용이 가능하도록 NativeEvent 를 한번 감싼 **SyntheticEvent** 를 제공해주고 있다. onClick 같은 React 이벤트 핸들러로 받는 event 는 모두 SyntheticEvent 이다.
이를 한글 번역에서는 이벤트 합성이라고 지칭하는 것 같다


# 이벤트 위임 활용
이벤트 위임을 직접 활용해볼 수도 있다. https://llddang-blog.tistory.com/73 이 글에서는 이벤트 위임을 통해 불필요한 렌더링을 줄였다.

처음에는 useMemo, useCallback, memo 를 통해 렌더링 최적화를 해내면 되지 않나? 라고 생각했지만 이것만으로 최적화가 힘든 경우가 있을수 있었다.

예를 들어
- 자식이 **Store 구독 안 하고**
- 핸들러 deps가 거의 안 바뀌거나, 그 수가 적고
- 각 아이템에 이벤트가 많지 않고
- props 갯수가 적절해서, 적절한 상태 변화가 있다면

이때는  useMemo, useCallback, memo 만으로도 의미가 있지만, 그렇지 않은 경우에 만약 렌더링 최적화를 고려한다면

상위(부모) 요소에 하나의 이벤트를 등록하고, 취급하고자 하는 타겟 핸들러 지정을 closest 으로 특정 지어서 처리한다면 최적화를 이뤄낼수 있다.

```tsx
export default function PokemonList() {
  const chosePokemons = useSelector((state: RootState) => state.pokemons);

  const choseIdSet = React.useMemo(
    () => new Set(chosePokemons.map(p => p.id)),
    [chosePokemons]
  );

  // ✅ 함수 identity 고정
  const isChose = React.useCallback(
    (id: number) => choseIdSet.has(id),
    [choseIdSet]
  );

  return (
    <PokemonListS.Grid>
      {POKEMON_DATA.map(pokemon => (
        <PokemonCard
          key={pokemon.id}
          isChose={isChose(pokemon.id)}
          pokemon={pokemon}
        />
      ))}
    </PokemonListS.Grid>
  );
}
```


# 이벤트 위임으로 기반으로
스터디를 하면서, 이벤트 위임을 기반으로

- Ref 의 사용은 이런 최적화에 빗겨나 있을것이다
- useCallback 같은 최적화가 크게 의미가 없을수 있다

라는 추측을 동료분이 언급했던것 같다. 하지만 이벤트 위임과 ref, useCallback 은 전혀 관련없는 내용인걸로 생각된다.

이유는
- ref 로 감싼다 하더라도, ref.addListener() 로 이벤트를 등록하지 않는 이상 Props 로 onClick 같은 이벤트 핸들러를 넘기면, 사용되는 이벤트는 **SyntheticEvent** 를 그대로 사용한다.
- 이벤트 위임이 내부적으로 적용되어 있다 하더라도, useCallback 이 최적화에 의미가 없다로 귀결되지 않는 것 같다.

이 부분은 동료에게 다시 한번더 확인하는 걸로!



# 참고 자료
https://alpha.velog.io/@ckdwns9121/React%EA%B0%80-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A5%BC-%EA%B4%80%EB%A6%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95%EC%97%90-%EB%8C%80%ED%95%B4-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0

https://llddang-blog.tistory.com/73

https://laurent.tistory.com/entry/React-React%EC%9D%98-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0

https://oraciondev.tistory.com/entry/React%EC%97%90%EC%84%9C-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A5%BC-%EC%B2%98%EB%A6%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95-with-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%9C%84%EC%9E%84%EA%B3%BC-%ED%95%A9%EC%84%B1

https://tech.kakaoent.com/front-end/2022/220908-react-event-and-browser-event/